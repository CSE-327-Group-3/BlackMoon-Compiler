<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlackMoon Compiler</title>
    <link rel="icon" type="image/x-icon" href="/static/blackmoon.ico">
    <link rel="shortcut icon" type="image/x-icon" href="/static/blackmoon.ico">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.2/ace.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.2/ext-language_tools.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm@5.3.0/css/xterm.min.css">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-left">
                <h1><i class="fas fa-code"></i> BlackMoon Compiler</h1>
                <div class="project-selector">
                    <select id="projectSelect">
                        <option value="">Select Project</option>
                    </select>
                    <button id="newProjectBtn" class="btn btn-primary">
                        <i class="fas fa-plus"></i> New Project
                    </button>
                </div>
            </div>
            <div class="header-right">
                <div class="language-selector">
                    <button id="askAiButton" class="btn btn-ai" title="Ask AI about your code">
                        <i class="fas fa-comments"></i> Ask AI
                    </button>
                    <label for="languageSelect">Language:</label>
                    <select id="languageSelect">
                        <option value="python">Python</option>
                        <option value="c">C</option>
                        <option value="cpp">C++</option>
                        <option value="java">Java</option>
                        <option value="javascript">JavaScript</option>
                        <option value="go">Go</option>
                        <option value="rust">Rust</option>
                    </select>
                </div>
                <div class="action-buttons">
                    <button id="runButton" class="btn btn-success">
                        <i class="fas fa-play"></i> Run
                    </button>
                    <button id="explainButton" class="btn btn-info">
                        <i class="fas fa-robot"></i> AI Explain
                    </button>
                    <button id="saveButton" class="btn btn-warning">
                        <i class="fas fa-save"></i> Save
                    </button>
                    <div class="profile-dropdown">
                        <div id="profileButton" class="profile-button">
                            <div class="profile-avatar" id="profileAvatar">
                                <i class="fas fa-user"></i>
                            </div>
                        </div>
                        <div id="profileMenu" class="profile-menu">
                            <div class="profile-menu-header">
                                <div class="profile-avatar-large" id="profileAvatarLarge">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="profile-menu-info">
                                    <strong id="profileUsername">User</strong>
                                    <span id="profileEmail">user@example.com</span>
                                </div>
                            </div>
                            <div class="profile-menu-divider"></div>
                            <button class="profile-menu-item" id="profileMenuItem">
                                <i class="fas fa-user-circle"></i> My Profile
                            </button>
                            <button class="profile-menu-item" id="mySharesMenuItem">
                                <i class="fas fa-share-alt"></i> My Shares
                            </button>
                            <button class="profile-menu-item" id="settingsMenuItem">
                                <i class="fas fa-cog"></i> Settings
                            </button>
                            <div class="profile-menu-divider"></div>
                            <button class="profile-menu-item danger" id="logoutMenuItem">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <div class="main-layout">
            <aside class="file-sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-folder"></i> Files</h3>
                    <div class="file-actions">
                        <button id="newFileBtn" class="btn btn-sm btn-primary" title="New File">
                            <i class="fas fa-file"></i>
                        </button>
                        <button id="newFolderBtn" class="btn btn-sm btn-secondary" title="New Folder">
                            <i class="fas fa-folder-plus"></i>
                        </button>
                    </div>
                </div>
                <div class="file-tree" id="fileTree">
                    <div class="empty-state">
                        <i class="fas fa-folder-open"></i>
                        <p>No project selected</p>
                    </div>
                </div>
            </aside>

            <main class="main-content">
                <div class="editor-panel">
                    <div class="editor-header">
                        <div class="file-tabs" id="fileTabs">
                            </div>
                        <div class="editor-controls">
                            <div class="font-controls">
                                <button id="fontDecrease" class="btn btn-sm btn-outline" title="Decrease font size">
                                    <i class="fas fa-magnifying-glass-minus"></i>
                                </button>
                                <button id="fontIncrease" class="btn btn-sm btn-outline" title="Increase font size">
                                    <i class="fas fa-magnifying-glass-plus"></i>
                                </button>
                            </div>
                            <button id="formatButton" class="btn btn-sm btn-outline">
                                <i class="fas fa-magic"></i> Format
                            </button>
                            <button id="settingsButton" class="btn btn-sm btn-outline">
                                <i class="fas fa-cog"></i>
                            </button>
                        </div>
                    </div>
                    <div class="editor-container">
                        <div id="codeEditor"></div>
                    </div>
                    <div class="error-panel" id="errorPanel">
                        <div class="error-panel-header">
                            <div class="error-count">
                                <div class="error-count-item errors">
                                    <i class="fas fa-times-circle"></i>
                                    <span id="errorCount">0</span> Errors
                                </div>
                                <div class="error-count-item warnings">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <span id="warningCount">0</span> Warnings
                                </div>
                            </div>
                            <button id="closeErrorPanelBtn" class="btn btn-sm btn-outline">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                        <ul class="error-list" id="errorList"></ul>
                    </div>
                </div>

                <div class="panel-resizer" id="terminalResizer" role="separator" aria-label="Resize terminal" aria-orientation="vertical" tabindex="0"></div>

                <div class="terminal-panel">
                    <div class="terminal-header">
                        <h3><i class="fas fa-terminal"></i> Terminal</h3>
                        <div class="terminal-controls">
                            <div class="terminal-font-controls" aria-label="Terminal font size controls">
                                <button id="terminalFontDecrease" class="btn btn-sm btn-outline" title="Decrease terminal font size">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <button id="terminalFontIncrease" class="btn btn-sm btn-outline" title="Increase terminal font size">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                            <button id="clearTerminalBtn" class="btn btn-sm btn-outline">
                                <i class="fas fa-trash"></i> Clear
                            </button>
                            <button id="toggleTerminalBtn" class="btn btn-sm btn-outline">
                                <i class="fas fa-chevron-down"></i>
                            </button>
                        </div>
                    </div>
                    <div class="terminal" id="terminal">
                        <div id="terminal-container" class="terminal-container"></div>
                    </div>
                </div>
            </main>
        </div>

        <div id="aiModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-robot"></i> AI Code Explanation</h2>
                    <button class="close-btn" id="closeAiModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="explanation-tabs">
                        <button class="tab-btn active" data-tab="comprehensive">Comprehensive</button>
                        <button class="tab-btn" data-tab="line-by-line">Line by Line</button>
                        <button class="tab-btn" data-tab="concepts">Concepts</button>
                    </div>
                    <div class="explanation-content" id="explanationContent">
                        </div>
                </div>
            </div>
        </div>

        <div id="newProjectModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-folder-plus"></i> Create New Project</h2>
                    <button class="close-btn" id="closeNewProjectModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="newProjectForm">
                        <div class="form-group">
                            <label for="projectName">Project Name:</label>
                            <input type="text" id="projectName" required placeholder="Enter project name">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancelNewProject">Cancel</button>
                            <button type="submit" class="btn btn-primary">Create Project</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="newFileModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-file"></i> Create New File</h2>
                    <button class="close-btn" id="closeNewFileModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="newFileForm">
                        <div class="form-group">
                            <label for="fileName">File Name:</label>
                            <input type="text" id="fileName" required placeholder="Enter file name (e.g., main.py)">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancelNewFile">Cancel</button>
                            <button type="submit" class="btn btn-primary">Create File</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="newFolderModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-folder-plus"></i> Create New Folder</h2>
                    <button class="close-btn" id="closeNewFolderModal">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="newFolderForm">
                        <div class="form-group">
                            <label for="folderName">Folder Path:</label>
                            <input type="text" id="folderName" required placeholder="Enter folder path (e.g., src/utils)">
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" id="cancelNewFolder">Cancel</button>
                            <button type="submit" class="btn btn-primary">Create Folder</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div id="profileModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-user-circle"></i> My Profile</h2>
                    <button class="close-btn" id="closeProfileModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="profile-section-content">
                        <div class="profile-preview">
                            <div class="profile-pic-large" id="profilePicPreview">
                                <i class="fas fa-user"></i>
                            </div>
                            <label for="profilePicInput" class="upload-btn">
                                <i class="fas fa-camera"></i> Change Picture
                            </label>
                            <input type="file" id="profilePicInput" accept="image/*" style="display: none;">
                        </div>
                        <form id="profileForm">
                            <div class="form-group">
                                <label>Username:</label>
                                <input type="text" id="profileUsernameDisplay" readonly>
                            </div>
                            <div class="form-group">
                                <label>Email:</label>
                                <input type="text" id="profileEmailDisplay" readonly>
                            </div>
                            <div class="form-group bio-group">
                                <label for="profileBio">
                                    <i class="fas fa-pen-fancy"></i> About Me
                                </label>
                                <textarea id="profileBio" rows="6" maxlength="500" placeholder="Share your story, skills, or what makes you awesome... âœ¨"></textarea>
                                <div class="bio-counter">
                                    <span id="bioCharCount">0</span> / 500 characters
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" id="cancelProfile">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save Profile</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div id="mySharesModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-share-alt"></i> My Shared Files</h2>
                    <button class="close-btn" id="closeMySharesModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="sharesList" class="shares-list">
                        </div>
                </div>
            </div>
        </div>

        <div id="shareLinkModal" class="modal">
            <div class="modal-content small-modal">
                <div class="modal-header">
                    <h2><i class="fas fa-share-nodes"></i> Share File</h2>
                    <button class="close-btn" id="closeShareLinkModal">&times;</button>
                </div>
                <div class="modal-body">
                    <p>Share this file with anyone using the link below:</p>
                    <div class="share-link-container">
                        <input type="text" id="shareLinkInput" readonly>
                        <button class="btn btn-primary" id="copyShareLinkBtn">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                    </div>
                    <p class="share-note"><i class="fas fa-info-circle"></i> Anyone with this link can view this file without logging in.</p>
                </div>
            </div>
        </div>

        <div id="settingsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2><i class="fas fa-cog"></i> Settings</h2>
                    <button class="close-btn" id="closeSettingsModal">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="settings-section">
                        <h3><i class="fas fa-robot"></i> AI Configuration</h3>
                        <div class="ai-status" id="aiStatus">
                            </div>
                        <form id="apiKeyForm">
                            <div class="form-group">
                                <label for="geminiApiKey">Google Gemini API Key:</label>
                                <input type="password" id="geminiApiKey" placeholder="Enter your Gemini API key">
                                <small class="form-text">Get your free API key from <a href="https://makersuite.google.com/app/apikey" target="_blank">Google AI Studio</a></small>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" id="cancelSettings">Cancel</button>
                                <button type="submit" class="btn btn-primary">Save API Key</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <div id="aiChatModal" class="modal">
            <div class="modal-content chat-modal">
                <div class="modal-header">
                    <h2><i class="fas fa-comments"></i> AI Assistant</h2>
                    <button class="close-btn" id="closeAiChatModal">&times;</button>
                </div>
                <div class="modal-body chat-body">
                    <div class="chat-context-selector">
                        <label>Context:</label>
                        <div class="context-options">
                            <label class="context-option">
                                <input type="checkbox" id="contextCurrentFile" checked>
                                <i class="fas fa-file-code"></i> Current File
                            </label>
                            <label class="context-option">
                                <input type="checkbox" id="contextProject">
                                <i class="fas fa-folder"></i> Whole Project
                            </label>
                            <label class="context-option">
                                <input type="checkbox" id="contextTerminal">
                                <i class="fas fa-terminal"></i> Terminal Output
                            </label>
                        </div>
                    </div>
                    <div class="chat-messages" id="chatMessages">
                        <div class="chat-welcome">
                            <i class="fas fa-robot fa-3x"></i>
                            <h3>Hi! I'm your AI coding assistant</h3>
                            <p>Ask me anything about your code, project, or errors you're seeing!</p>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <textarea id="chatInput" placeholder="Ask me anything about your code..." rows="2"></textarea>
                        <button id="sendChatBtn" class="btn btn-primary">
                            <i class="fas fa-paper-plane"></i> Send
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/xterm@5.3.0/lib/xterm.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit@0.8.0/lib/xterm-addon-fit.min.js"></script>
    <script src="/static/script.js"></script>
</body>
</html>
